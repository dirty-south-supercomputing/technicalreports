\chapter{Attacks\label{chap:attacks}}
A Pokémon deals damage in battle via two types of attacks.
``Fast'' attacks generate the energy required by powerful ``charged'' attacks.
Energy is per-Pokémon and preserved across substitution (but not across battles).
Every attack has a (single) type, which may or may not be a type of the attacker.
Attacks having a type in common with the attacker enjoy a 1.2x multiplier, the Same Type Attack Bonus (STAB).
A single attack usually has different stats for Nx1 (\autoref{sec:nx1})
  and 3x3 (\autoref{sec:3x3}) battles.
Unless otherwise stated, we're working with the values for 3x3.

As developed in \autoref{sec:dualtypes}, an attack's type effectiveness
  against a given opponent ranges from −3 to 2, inclusive.
See \autoref{sec:typemult} for the quantitative impact of type effectiveness.
Using \autoref{table:relations}, we assign each attacking type $A$ four values
  $R_{-2}\cdots{}R_1$, where $R_n$ is the number of types against which $A$ has a
  relation of $n$.
To calculate the number of typings $E_n$ against which $A$ has some effectiveness $n$,
  use the following relations (\autoref{table:attackeff}):
\begin{align*}
  E_{−3} &= R_{−2}R_{−1}\\
  E_{−2} &= R_{−2}(R_0 + 1) + \binom{R_{−1}}{2}\\
  E_{−1} &= R_{−1}(R_0 + 1) + R_{−2}R_1\\
   E_{0} &= R_0 + \binom{R_0}{2} + R_{1}R_{−1}\\
   E_{1} &= R_{1}(R_0 + 1)\\
   E_{2} &= \binom{R_1}{2}\\
   \ARA &= \sum_{n=-3}^{2} \frac{E_{n}1.6^n}{171}
\end{align*}
under the invariants:
\begin{align*}
    \sum_{i=−2}^{1} R_i &= 18\\
   \sum_{i=−3}^{2} E_i + 18 &= \binom{18}{2} + 18  = 171
\end{align*}
\begin{table}
  \centering
  \begin{tabular}{l r r r r|r r r r r r r}
    & \multicolumn{4}{c}{Type → Type} & \multicolumn{6}{c}{Type → Typing} & \\
    & \multicolumn{4}{c}{\raisebox{-4pt}{$\overbrace{\hspace{2cm}}$}} & \multicolumn{6}{c}{\raisebox{-4pt}{$\overbrace{\hspace{4cm}}$}} & \\
    $A$ & −2 & −1 & 0 & 1 & −3 & −2 & −1 & 0 & 1 & 2 & \ARA \\
    \Midrule
\calign{\includegraphics[height=1em,keepaspectratio]{images/ground.png}} & 1 & 2 & 10 & 5 & 2 & 12 & 27 & 65 & 55 & 10 & 1.173 \\
\calign{\includegraphics[height=1em,keepaspectratio]{images/rock.png}} & 0 & 3 & 11 & 4 & 0 & 3 & 36 & 78 & 48 & 6 & 1.134 \\
\calign{\includegraphics[height=1em,keepaspectratio]{images/fire.png}} & 0 & 4 & 10 & 4 & 0 & 6 & 44 & 71 & 44 & 6 & 1.091 \\
\calign{\includegraphics[height=1em,keepaspectratio]{images/ice.png}} & 0 & 4 & 10 & 4 & 0 & 6 & 44 & 71 & 44 & 6 & 1.091 \\
\calign{\includegraphics[height=1em,keepaspectratio]{images/water.png}} & 0 & 3 & 12 & 3 & 0 & 3 & 39 & 87 & 39 & 3 & 1.068 \\
\calign{\includegraphics[height=1em,keepaspectratio]{images/fairy.png}} & 0 & 3 & 12 & 3 & 0 & 3 & 39 & 87 & 39 & 3 & 1.068 \\
\calign{\includegraphics[height=1em,keepaspectratio]{images/flying.png}} & 0 & 3 & 12 & 3 & 0 & 3 & 39 & 87 & 39 & 3 & 1.068 \\
\calign{\includegraphics[height=1em,keepaspectratio]{images/fighting.png}} & 1 & 5 & 7 & 5 & 5 & 18 & 45 & 53 & 40 & 10 & 1.047 \\
\calign{\includegraphics[height=1em,keepaspectratio]{images/steel.png}} & 0 & 4 & 11 & 3 & 0 & 6 & 48 & 78 & 36 & 3 & 1.027 \\
\calign{\includegraphics[height=1em,keepaspectratio]{images/ghost.png}} & 1 & 1 & 14 & 2 & 1 & 15 & 17 & 107 & 30 & 1 & 1.019 \\
    \calign{\includegraphics[height=1em,keepaspectratio]{images/dark.png}} & 0 & 3 & 13 & 2 & 0 & 3 & 42 & 97 & 28 & 1 & 1.005 \\
\calign{\includegraphics[height=1em,keepaspectratio]{images/psychic.png}} & 1 & 2 & 13 & 2 & 2 & 15 & 30 & 95 & 28 & 1 & 0.979 \\
\calign{\includegraphics[height=1em,keepaspectratio]{images/dragon.png}} & 1 & 1 & 15 & 1 & 1 & 16 & 17 & 121 & 16 & 0 & 0.957 \\
    \calign{\includegraphics[height=1em,keepaspectratio]{images/electric.png}} & 1 & 3 & 12 & 2 & 3 & 16 & 41 & 84 & 26 & 1 & 0.94 \\
\calign{\includegraphics[height=1em,keepaspectratio]{images/bug.png}} & 0 & 7 & 8 & 3 & 0 & 21 & 63 & 57 & 27 & 3 & 0.909 \\
\calign{\includegraphics[height=1em,keepaspectratio]{images/grass.png}} & 0 & 7 & 8 & 3 & 0 & 21 & 63 & 57 & 27 & 3 & 0.909 \\
\calign{\includegraphics[height=1em,keepaspectratio]{images/poison.png}} & 1 & 4 & 11 & 2 & 4 & 18 & 50 & 74 & 24 & 1 & 0.902 \\
    \calign{\includegraphics[height=1em,keepaspectratio]{images/normal.png}} & 1 & 2 & 15 & 0 & 2 & 17 & 32 & 120 & 0 & 0 & 0.86 \\
\end{tabular}
    \caption[Attack type effectiveness summaries]{Attack type effectiveness summaries (higher is better)\label{table:attackeff}}
\end{table}

\section{Fast attacks}
Each Pokémon species (\autoref{chap:species}) is capable of learning some set of fast attacks, 
  and every Pokémon knows exactly one at a time (except Smeargle---see \autoref{subsec:smeargle}).
A fast attack is defined by its duration, its power, and the energy built up with each use (\autoref{table:fastattacks}),
  and these values can be different between 3x3 and Nx1 battles.
If fast attack $A$ is stronger than fast attack $B$ in Nx1 mode, it will not be
  weaker than $B$ in 3x3 mode, and vice versa (i.e.\ partial ordering is maintained).
Furthermore, no fast attack's Nx1 power is less than its 3x3 power.
Each Pokémon can store up to 100 units of energy, which is preserved across substitutions.
\PPT{} and \EPT{} are power and energy, respectively, normalized per turn.
Incinerate is thus the most powerful fast attack in both modes.
It is also the only five turn attack, and the only one to hit 4 with both \EPT{} and \PPT{}\@.
Charm stands alone with a \PPT{} of 5, with Razor Leaf coming in behind it at 4.5.
Lock On manages 5 \EPT{}, with Psycho Cut, Poison Sting, Fairy Wind, Karate Chop,
  and Thunder Shock at 4.5.
Fast attack counts are broken down by type in \autoref{table:attacktypes},
 and \autoref{chap:attackemployers} provides lists of Pokémon which can use each attack.
\input{out/fastattacks}
\input{out/attacktypes}
Hidden Power is of some random type that is neither Normal nor Fairy.
The type is persisted across trades, but not across evolution,
 and cannot be changed via TMs.

\begin{figure}[ht]
\includegraphics[keepaspectratio,width=\textwidth]{octave/pptvst.png}
  \caption{\PPT{} vs turns for fast attacks\label{fig:pptvst}}
\end{figure}

\begin{figure}[hb]
\includegraphics[keepaspectratio,width=\textwidth]{octave/eptvst.png}
  \caption{\EPT{} vs turns for fast attacks\label{fig:eptvst}}
\end{figure}

\section{Charged attacks\label{sec:charged}}
Every Pokémon knows at least one charged attack, and most can be taught a second
  %Applin, Combee, Cosmoem, Cosmog, Ditto, Gimmighoul, Toxel, Unown, and Wimpod are exceptions;
  charged attack at a cost of Stardust and Candy\footnote{\input{out/nosecondcharged}
  lacking second charged attacks to learn.}.
The Dragon Ascent attack of Rayquaza cannot be learned via any method other
  than a rare Meteorite.
A charged attack is defined by its power and the energy it consumes (\autoref{table:chargedattacks}).
Energy generated by the fast attack goes into a pool from which either charged attack can draw.
Unlike fast attacks, partial ordering is not generally preserved between Nx1 and 3x3 mode:
  Sunsteel Strike is the most powerful charged attack in Nx1, whereas Aeroblast tops
  the list in 3x3.
No, I don't know why they spelled ``Spacial'' Rend like that.
\input{out/chargedattacks}

In 3x3, each side starts with two Damage Shields.
The Trainer can deploy a shield whenever the opponent prepares a charged attack,
   and the decision must be made before the particular attack is revealed.
Shields reduce the incoming damage to a single point, and each can be used only once.

\autoref{fig:dpevse} plots Power-per-Energy (PPE) against energy for charged attacks.
A higher PPE makes more efficient use of the energy built up by fast attacks.
A lower energy requires fewer fast attacks to build up its charge.
Note that many of the best PPEs do not require extreme energy; these make
 for excellent charged attacks.
\begin{figure}[ht]
\includegraphics[keepaspectratio,width=\textwidth]{octave/dpevse.png}
  \caption{PPE vs energy for charged attacks\label{fig:dpevse}}
\end{figure}

\begin{tipbox}[title=Did you notice?]
Every charged attack's power is a multiple of five, and thus multiplying it by 1.2 or 1.6 always results in an integer.
\end{tipbox}

\subsection{Adventure Effects\label{sec:effects}}
Certain charged attacks can be employed outside of battle.
Some Pokémon must know the attack, and that Pokémon cannot be fainted.
Adventure effects cost Stardust and Candy appropriate to the Pokémon
  per duration (\autoref{table:adveffects}).
\begin{table}
\centering
\begin{tabular}{llrr}
Attack & Pokémon & Cost & Time\\
\Midrule
Roar of Time & Origin Forme Dialga & 5 & 6\\
  & \multicolumn{3}{r}{\footnotesize{}Pause incense, Lucky Egg, and Star Piece timers}\\
Spacial Rend & Origin Forme Palkia & 5 & 10\\
  & \multicolumn{3}{r}{\footnotesize{}Encounter wild Pokémon at greater distance}\\
Ice Burn & White Kyurem & 5 & 10\\
  & \multicolumn{3}{r}{\footnotesize{}Slow down catch circles, +50\% to catch rate}\\
Freeze Shock & Black Kyurem & 5 & 10\\
  & \multicolumn{3}{r}{\footnotesize{}Stops movement in encounters, +25\% to catch rate}\\
Sunsteel Strike & Dusk Mane Necrozma & 3 & 10\\
  & \multicolumn{3}{r}{\footnotesize{}Spawn and evolve daytime Pokémon}\\
Moongeist Beam & Dawn Wings Necrozma & 3 & 10\\
  & \multicolumn{3}{r}{\footnotesize{}Spawn and evolve evening Pokémon}\\
Behemoth Blade & Crowned Sword Zacian & 5 & 6\\
  & \multicolumn{3}{r}{\footnotesize{}+10\% to ATK in raids, +5\% in Max Battles}\\
Behemoth Bash & Crowned Shield Zamazenta & 5 & 6\\
  & \multicolumn{3}{r}{\footnotesize{}10\% to DEF in raids, +5\% in Max Battles}\\
Dynamax Cannon & Eternatus & 5/30 & 10\\
  & \multicolumn{3}{r}{\footnotesize{}Boosts Max Move levels by 1 for true Max Pokémon}\\
\end{tabular}
\caption[Adventure effects of charged attacks]{Adventure effects of charged attacks. Cost is expressed in units of 1,000 Stardust and Candy.\label{table:adveffects}}
\end{table}
Dynamax Cannon's effect does not affect the Max Moves of Zacian nor Zamazenta,
 and costs a painful 30 Eternatus Candy.

\subsection{Buffs and debuffs\label{sec:buffs}}
Certain charged attacks have a chance of semi-persistent effects on the
  attack or defense of the user or opponent.
These effects can be positive (``buffs'') or negative (``debuffs''\footnote{I am unenamored of the term ``debuff'',
  suggesting only that it can undo a buff. But this is not just community lingo---it's in the
  game's interfaces.}) (no attacks buff opponents at this time).
They occur only in 3x3 battles, and are affected by neither shields nor typing.
Several attacks (Ancient Power, Obstruct, Ominous Wind, Signal Beam, Silver
  Wind, Superpower, Tri Attack) can have multiple effects; in this case, any
  probabilistic check is done once for all effects---either all of them
  occur, or none of them do.
The effects apply only to the active Pokémon, and do not persist across substitution.
Stat changes stack, but the absolute value will not exceed four.
See \autoref{sec:mbmult} for a quantitative treatment.

\subsection{The type advantages of two charged attacks\label{sec:dualcharged}}
Two charged attacks can yield tremendous improvements in type effectiveness.
Unlike typing with regard to defense, where we must take the sum of each type's
 weaknesses and strengths, we choose a single charged attack.
For each target typing, we can apply the better of the two type relations.
Two charged attacks of different type have coverage at least as good as,
  and usually much better than, a single type.
There is no pair of distinct attack types forced into a −3 relation.
Recall that our best \ARA{} was Ground with 1.173.
More than 72\% of dual charged attack setups beat this coverage,
 with Ground+Ice posting an outstanding 1.468.
Only one pair can be forced into a dreaded effectiveness of −3:
 Normal with Poison, when matched against Steel+Ghost.
\input{out/dualcharged}

\section{Cover sets\label{sec:coversets}}
With one fast and two charged attacks per Pokémon, a team of three can boast nine distinct attack types.
Can we achieve coverage of the defenders' typing with this limited repertoire?
Were we working against only monotyped Pokémon, nine types would be more than sufficient.
The smallest cover of all eighteen types is achieved with seven attacking types in
  ten different collections (\autoref{table:coversetsmono}).
Fighting is always necessary to gain advantage over Normal, and Ground is required for Electric.
No other types show up in all covering sets.
\begin{table}
\centering
\begin{tabular}{c}
Dark, Electric, Fighting, Flying, Ground, Ice, Poison\\
Dark, Electric, Fighting, Flying, Ground, Ice, Steel\\
Dark, Fairy, Fighting, Grass, Ground, Poison, Rock\\
Dark, Fighting, Flying, Grass, Ground, Ice, Poison\\
Dark, Fighting, Flying, Grass, Ground, Ice, Steel\\
Electric, Fighting, Flying, Ghost, Ground, Ice, Poison\\
Electric, Fighting, Flying, Ghost, Ground, Ice, Steel\\
Fairy, Fighting, Ghost, Grass, Ground, Poison, Rock\\
Fighting, Flying, Ghost, Grass, Ground, Ice, Poison\\
Fighting, Flying, Ghost, Grass, Ground, Ice, Steel\\
\end{tabular}
\caption{Monotypes are minimally covered by 10 sets of 7\label{table:coversetsmono}}
\end{table}

It's interesting to look at how these sets change if we ignore one target type.
Dropping Fairy, Normal, or Water results in coverage using only six attacking types,
  and can thus be handled with only charged attacks.
Dropping Dark, Fire, Ice, Poison, Psychic, Rock, or Steel doesn't change the solution space at all.
The remaining eight elisions merely enable more septuples (\autoref{table:partialcovers}).
\begin{table}
\centering
  \begin{tabular}{lrr|lrr}
    Ignored type & Cover size & Sets & Ignored type & Cover size & Sets\\
    \Midrule
    Bug & 7 & 30 & Dragon & 7 & 24\\
    Electric & 7 & 22 & Fairy & 6 & 4\\
    Fighting & 7 & 28 & Flying & 7 & 22\\
    Ghost & 7 & 16 & Grass & 7 & 12\\
    Ground & 7 & 24 & Normal & 6 & 2\\
    Water & 6 & 4 & & & \\
  \end{tabular}
  \caption{Partial covers are comparable in size to a full cover\label{table:partialcovers}}
\end{table}

Of course, what we're really interested in covering is the full set
  of possible target typings, including all dualtypes.
Unfortunately, this requires no fewer than ten attacking types,
  which can be selected in nine different ways (\autoref{table:coversetsdual}).
Even assuming unlimited substitution, this demonstrates the
  impossibility of assembling a team which can effectively
  hit every possible opposing Pokémon with some attack.
However, \autoref{sec:typeleagues} explores situations where typing is restricted.
In such cases, the minimum set concept is extremely powerful.
It can furthermore be put to good use analyzing your own teams.
Every typing is weak to at least one attack type, so the minimum
 cover will never be greater than three.
A number below that indicates types that are effective against
 multiple members of your team.
That's not necessarily a bad thing, but you'll want to know about it.

\begin{table}
  \centering
  \begin{tabular}{c}
 Dark, Fairy, Fighting, Fire, Grass, Ground, Poison, Rock, Steel, Water\\
 Dark, Fairy, Fighting, Fire, Grass, Ground, Ice, Poison, Rock, Steel\\
 Dark, Fairy, Fighting, Fire, Ghost, Grass, Ground, Poison, Rock, Water\\
 Dark, Fairy, Fighting, Fire, Ghost, Grass, Ground, Ice, Poison, Rock\\
 Dark, Fairy, Fighting, Fire, Flying, Grass, Ground, Rock, Steel, Water\\
 Dark, Fairy, Fighting, Fire, Flying, Grass, Ground, Ice, Rock, Steel\\
 Dark, Electric, Fairy, Fighting, Fire, Flying, Grass, Ground, Ice, Steel\\
 Bug, Dark, Fairy, Fighting, Fire, Grass, Ground, Rock, Steel, Water\\
 Bug, Dark, Fairy, Fighting, Fire, Grass, Ground, Ice, Rock, Steel\\
  \end{tabular}
  \caption{Full typing is minimally covered by 9 sets of 10\label{table:coversetsdual}}
\end{table}

\section{Relative strength of fast and charged attacks\label{sec:fastvcharged}}
It's sometimes useful to delay use of a charged attack, but is it ever wise to forgo
  charged attacks entirely?
Fast attack power ranges from 1 (Locked On) to 20 (Incinerate), but we need look at
  the power per turn (charged attacks operate in a single turn in Trainer Battles).
Using normalized power, Charm takes the lead with 5 \PPT{}\@.
Assume STAB and type effectiveness of 2 for Charm, boosting it to 15.36 \PPT{}\@.
This is the best case for fast attacks.

Charged attack power ranges from 10 (Frustration) to 170 (Sunsteel Strike).
Assuming no STAB and type effectiveness of −1 for Frustration, it is reduced to 6.25,
  and in this pathological case will inflict less damage per turn than the fast attack.
At even the meager 20 of Acid Spray and friends, however, the −1 type relation only
  drives power down to 12.5.
Unless you're making use of Frustration or Obstruct,
  or in a situation of at least double ineffectiveness or effectiveness,
  charged attacks are always more efficient dealers of damage than fast attacks \textit{so long
  as they aren't shielded.}
Fast attacks are subject to more floor functions, and hit harder by them.
An implication is that STAB and type effectiveness will have more impact on
 charged attacks than fast attacks.

This \textit{does not} imply that charged attacks ought always be used as soon as
  sufficient energy has been built up.
There are numerous tactical reasons to hold off on a charged attack (\autoref{chap:strategy}).
Due to charged attacks immediately concluding opponents' fast attacks,
 it is even possible to lose by throwing a shielded charged attack, when
 a fast attack might have knocked out the opponent.

It is true that a charged attack requires energy built up over a number of turns.
Were these considered, and used to calculate \PPT{} for the charged attack,
  it might well fall below that of the fast attack.
Such a comparison is invalid; the energy is built up as a result of the fast attack.
The question is whether the charged attack ought be used, presuming sufficient energy present.
At that point, the time cost of the charged attack is one turn.

None of this analysis holds for Nx1 battles, where charged attacks can have much more lengthy durations.
In Gigantamax battles, it can be beneficial to eschew charged attacks completely;
 more total power is delivered by filling up the Max Meter as quickly as possible,
 and throwing Max attacks more frequently (\autoref{sec:maxbattles}).

\section{Minimal attack cycles\label{sec:minimalcycles}}
9,379 combinations of fast and charged attack are currently in play.
For each combination of fast attack and charged attack, there is some minimum number
 $F$ of fast attacks sufficient to launch the charged attack.
The shortest attack cycles require nine turns (\autoref{table:fastcycles}),
 while the longest take forty-three---time for the fastest opponents to
 throw four full cycles, with headway on the fifth.
The ``\%c'' column in \autoref{table:fastcycles} indicates the percentage of total
 power delivered by the charged attack.
The minimum is 15.62\%, when Victreebel employs Razor Leaf together with Acid Spray.
Outside of fast attacks which deal no damage (Yawn and Splash), \%c is maximized (91.84\%)
 by Regieleki when Lock On is followed by Zap Cannon
 (in fact, all pairs with \%c over 90\% are Lock On with some heavy charged attack).
Nothing with \%c below 27\% manages to achieve even 7 PPT, while
 those with \%c above 90\% all exceed 9.75 PPT; this shouldn't surprise
 us, given the results of \autoref{sec:fastvcharged}.
PPT of 5 or below is a wasteland of fast attacks like Tackle, Take Down, Pound, and Bug Bite,
 and charged attacks like Struggle, Acid Spray, Fell Stinger, and of course the dreadful Frustration.
Most of these combinations aren't even fast; they're just pathologically bad attacks.
The maximum PPT is 14.25, achieved by Incinerate together with Overheat or Brave Bird, all with STAB.
Both of these charged attacks have deleterious effects on their user.
This is a trend: among the 1,188 pairs ($\sim$12.7\%) with PPT of at least ten,
 many come with a mandatory negative status effect.
The exceptions on the high end---Poltergeist, Solar Beam, Fire Blast, Zap Cannon---tend towards twenty turns per cycle.
Blast Burn is faster; Frenzy Plant is faster than Blast Burn; Dynamic Punch is faster than Frenzy Plant.
But fastest of them all is Morpeko wielding Thunder Shock and Aura Wheel, pumping out 13.09 PPT
 in eleven turns, \textit{while getting a buff to attack}.
If Electric and Dark had better type coverage, Morpeko would be unstoppable.
None of the fastest cycles break a PPT ceiling of 10, all of them employing Karate Chop with Cross Chop.
Primeape can switch this combo up with the equally speedy Rage Fist (sadly without STAB)
 when Fighting is ineffective.
\input{out/timetofirst}

\section{Technical Machines\label{sec:tms}}
Four kinds of Technical Machines (TMs) allow a Pokémon to change its attacks outside of battle.
There are fast and charged TMs, and Elite variants of each.
The normal version of TMs select a random new move from the Pokémon's attack set (though a charged TM will not replace
 a charged attack with one the Pokémon already knows).
If the Pokémon knows two charged attacks, the Trainer can choose which attack is replaced.
The Elite variants allow the new attack to be chosen, and allow learning (most) elite moves.
Elite attacks can otherwise be acquired only during special events.
Outside of Team GO Rocket ``Taken Over'' events, the Frustration charged attack cannot be
 changed, even with an Elite TM.
During these events, a regular charged TM will suffice to replace Frustration.
Purified Pokémon can change Return at any time, but it can never be learned again.
\input{out/elite}
